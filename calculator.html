<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Heat Pump Rebate Calculator | APEX Heat Pumps</title>
  <meta name="description" content="Estimate your CleanBC, Canada Greener Homes, and municipal heat pump rebates with APEX Heating & Cooling's quick calculator.">
  <style>
    :root {
      --apx-orange: #ff6b35;
      --apx-dark: #0e0f11;
      --apx-slate: #1f2933;
      --apx-light: #f5f7fa;
    }
    * {
      box-sizing: border-box;
    }
    body {
      margin: 0;
      font-family: "Segoe UI", system-ui, -apple-system, sans-serif;
      color: var(--apx-slate);
      background: #fff;
      line-height: 1.6;
    }
    a {
      color: inherit;
    }
    header {
      background: var(--apx-dark);
      color: #fff;
      padding: 20px clamp(16px, 4vw, 48px);
      display: flex;
      align-items: center;
      justify-content: space-between;
      flex-wrap: wrap;
      gap: 12px;
    }
    header h1 {
      margin: 0;
      font-size: clamp(1.5rem, 2vw, 2rem);
      letter-spacing: 0.02em;
    }
    header nav {
      display: flex;
      gap: 8px;
      flex-wrap: wrap;
    }
    header nav a {
      text-decoration: none;
      font-weight: 600;
      padding: 6px 12px;
      border-radius: 999px;
      transition: background 0.2s ease;
    }
    header nav a:hover,
    header nav a:focus {
      background: rgba(255, 255, 255, 0.12);
    }
    .header-actions {
      display: flex;
      gap: 8px;
      flex-wrap: wrap;
    }
    .header-actions a {
      text-decoration: none;
      font-weight: 600;
      padding: 6px 12px;
      border-radius: 999px;
      background: rgba(255, 255, 255, 0.12);
      transition: background 0.2s ease;
    }
    .header-actions a:hover,
    .header-actions a:focus {
      background: rgba(255, 255, 255, 0.22);
    }
    main {
      padding: clamp(24px, 5vw, 60px) clamp(16px, 6vw, 80px);
      max-width: 1000px;
      margin: 0 auto;
    }
    .back-link {
      display: inline-flex;
      align-items: center;
      gap: 6px;
      margin-bottom: 24px;
      font-weight: 600;
      text-decoration: none;
    }
    .hero {
      background: var(--apx-light);
      padding: clamp(20px, 4vw, 36px);
      border-radius: 20px;
      box-shadow: 0 20px 40px rgba(14, 15, 17, 0.06);
      margin-bottom: 32px;
    }
    .hero h2 {
      margin-top: 0;
      font-size: clamp(1.75rem, 3vw, 2.4rem);
      color: var(--apx-dark);
    }
    .hero p {
      margin-bottom: 0;
      color: #52606d;
    }
    form {
      background: #fff;
      border-radius: 24px;
      padding: clamp(20px, 4vw, 40px);
      box-shadow: 0 16px 32px rgba(15, 23, 42, 0.08);
      display: grid;
      gap: 20px;
    }
    fieldset {
      border: none;
      padding: 0;
      margin: 0;
      display: grid;
      gap: 12px;
    }
    fieldset legend {
      font-size: 1.1rem;
      font-weight: 700;
      color: var(--apx-dark);
      margin-bottom: 4px;
    }
    label {
      display: grid;
      gap: 6px;
      font-weight: 600;
      color: #334155;
    }
    input, select, textarea, button {
      font: inherit;
      padding: 12px 14px;
      border: 1px solid #cbd5e1;
      border-radius: 12px;
    }
    input:focus, select:focus, textarea:focus {
      outline: 2px solid rgba(255, 107, 53, 0.35);
      border-color: rgba(255, 107, 53, 0.35);
    }
    button[type="submit"] {
      background: var(--apx-orange);
      color: #fff;
      font-weight: 700;
      border: none;
      cursor: pointer;
      transition: transform 0.2s ease, box-shadow 0.2s ease;
    }
    button[type="submit"]:hover {
      transform: translateY(-2px);
      box-shadow: 0 12px 24px rgba(255, 107, 53, 0.25);
    }
    .result-panel {
      background: #fff9f6;
      border: 1px solid rgba(255, 107, 53, 0.35);
      border-radius: 20px;
      padding: 24px;
      display: grid;
      gap: 16px;
    }
    .result-panel h3 {
      margin: 0;
      font-size: 1.4rem;
      color: var(--apx-dark);
    }
    .result-grid {
      display: grid;
      gap: 12px;
    }
    .result-item {
      display: flex;
      justify-content: space-between;
      align-items: baseline;
      border-bottom: 1px solid rgba(15, 23, 42, 0.08);
      padding-bottom: 8px;
    }
    .result-item strong {
      font-size: 1.05rem;
    }
    .status-message {
      font-weight: 600;
      color: #0b7a35;
      display: none;
    }
    .status-message.error {
      color: #d14343;
    }
    .contact-card {
      margin-top: 40px;
      background: #0e0f11;
      color: #fff;
      border-radius: 24px;
      padding: clamp(24px, 5vw, 36px);
      display: grid;
      gap: 12px;
    }
    .contact-card a {
      color: #fff;
      text-decoration: underline;
      font-weight: 600;
    }
    footer {
      text-align: center;
      padding: 32px 16px 48px;
      color: #64748b;
    }
  </style>
</head>
<body>
  <header>
    <h1>APEX Heat Pumps</h1>
    <nav aria-label="Primary navigation">
      <a href="index.html">Home</a>
      <a href="about.html">About</a>
      <a href="services.html">Services</a>
      <a href="rebates.html">Rebates</a>
      <a href="contact.html">Contact</a>
    </nav>
    <div class="header-actions" aria-label="Get in touch">
      <a href="tel:6044426711">Call 604-442-6711</a>
      <a href="mailto:info@apexheatpumps.ca">Email Us</a>
    </div>
  </header>

  <main>
    <a class="back-link" href="index.html">← Back to Home</a>

    <section class="hero">
      <h2>CleanBC & Canada Greener Homes Rebate Calculator</h2>
      <p>Answer a few quick questions about your home and planned heat pump upgrade to estimate the rebates available from CleanBC, Canada Greener Homes, and municipal top-ups. You can send the results to our team for a personalized proposal.</p>
    </section>

    <form id="rebate-calculator" aria-describedby="calculator-status">
      <input type="hidden" name="access_key" value="bfc609cd-6bf1-4d82-9c46-b739906dae10">
      <fieldset>
        <legend>Home Details</legend>
        <label>
          Your Name
          <input type="text" name="name" placeholder="Jane Contractor" autocomplete="name" required>
        </label>
        <label>
          Email Address
          <input type="email" name="email" placeholder="you@example.com" autocomplete="email" required>
        </label>
        <label>
          Phone Number
          <input type="tel" name="phone" placeholder="604-000-0000" autocomplete="tel" required>
        </label>
        <label>
          Project Address (City)
          <input type="text" name="city" placeholder="Vancouver" autocomplete="address-level2">
        </label>
        <label>
          Home Type
          <select name="home_type" required>
            <option value="detached">Detached House</option>
            <option value="townhome">Townhome / Rowhouse</option>
            <option value="condo">Condo / Apartment</option>
          </select>
        </label>
      </fieldset>

      <fieldset>
        <legend>Existing Heating</legend>
        <label>
          Current Primary Heating Source
          <select name="existing_heating" required>
            <option value="natural_gas">Natural Gas Furnace/Boiler</option>
            <option value="electric_baseboards">Electric Baseboards</option>
            <option value="oil_or_propane">Oil or Propane Furnace</option>
          </select>
        </label>
        <label>
          Are you a BC Hydro electricity customer?
          <select name="bc_hydro" required>
            <option value="yes">Yes</option>
            <option value="no">No</option>
          </select>
        </label>
        <label>
          Household Income (before tax)
          <select name="household_income" required>
            <option value="under_117">Under $117,000</option>
            <option value="117_180">$117,000 – $180,000</option>
            <option value="over_180">Over $180,000</option>
          </select>
        </label>
      </fieldset>

      <fieldset>
        <legend>Heat Pump Upgrade</legend>
        <label>
          Heat Pump System Type
          <select name="heat_pump_type" required>
            <option value="central">Central Ducted Heat Pump</option>
            <option value="cold_climate">Cold-Climate Ducted Heat Pump</option>
            <option value="ductless_single">Ductless Single Zone</option>
            <option value="ductless_multi">Ductless Multi-Zone (2+ heads)</option>
          </select>
        </label>
        <label>
          Estimated Installed Cost (after tax)
          <input type="number" name="project_cost" min="0" step="500" placeholder="18000" required>
        </label>
        <label>
          Additional Notes
          <textarea name="notes" rows="3" placeholder="Any details we should know?"></textarea>
        </label>
      </fieldset>

      <button type="submit">Calculate Rebates &amp; Send Results</button>
      <p id="calculator-status" class="status-message" role="status" aria-live="polite"></p>
    </form>

    <section class="result-panel" aria-live="polite">
      <h3>Estimated Rebates</h3>
      <div class="result-grid" id="rebate-results">
        <p>Fill out the form above and click "Calculate Rebates" to see your personalized estimate.</p>
      </div>
      <p><strong>Disclaimer:</strong> Rebates shown are estimates only. Final eligibility depends on program rules, pre-approval steps, and equipment specifications. Our HPCN-certified team will confirm exact rebate amounts for your installation.</p>
    </section>

    <aside class="contact-card">
      <h3>Need help planning your project?</h3>
      <p>We are CleanBC registered contractors serving Metro Vancouver. Call <a href="tel:6044426711">604-442-6711</a> or email <a href="mailto:info@apexheatpumps.ca">info@apexheatpumps.ca</a> for a free consultation.</p>
    </aside>
  </main>

  <footer>
    © APEX Heating & Cooling Ltd. · HPCN Certified · Serving Metro Vancouver
  </footer>

  <script>
    const form = document.getElementById('rebate-calculator');
    const resultsContainer = document.getElementById('rebate-results');
    const statusMessage = document.getElementById('calculator-status');

    const baseRebates = {
      central: 5000,
      cold_climate: 7000,
      ductless_single: 3000,
      ductless_multi: 4500
    };

    const programLabels = {
      cleanbc: 'CleanBC Better Homes',
      greenerHomes: 'Canada Greener Homes',
      incomeTopUp: 'CleanBC Income Qualified',
      municipal: 'Municipal / Regional Top-Up',
      total: 'Total Estimated Rebates'
    };

    function formatCurrency(value) {
      return new Intl.NumberFormat('en-CA', { style: 'currency', currency: 'CAD', maximumFractionDigits: 0 }).format(value);
    }

    function calculateRebates(data) {
      const cleanBC = baseRebates[data.heat_pump_type] || 0;
      const greenerHomes = cleanBC > 0 ? 5000 : 0;
      let incomeTopUp = 0;
      if (data.household_income === 'under_117') {
        incomeTopUp = 6000;
      } else if (data.household_income === '117_180') {
        incomeTopUp = 2000;
      }

      let municipal = 0;
      if (data.city && /north vancouver|richmond|burnaby|vancouver/i.test(data.city)) {
        municipal = 2000;
      }

      if (data.existing_heating === 'electric_baseboards') {
        municipal += 500;
      }

      if (data.bc_hydro === 'yes' && data.existing_heating !== 'electric_baseboards') {
        municipal += 1000; // FortisBC & BC Hydro top-up combo estimate
      }

      const projectCost = Number.parseFloat(data.project_cost || '0');
      const totalRebates = Math.min(cleanBC + greenerHomes + incomeTopUp + municipal, projectCost * 0.9);

      return {
        cleanbc: cleanBC,
        greenerHomes,
        incomeTopUp,
        municipal,
        total: totalRebates
      };
    }

    function renderResults(breakdown, cost) {
      resultsContainer.innerHTML = '';
      Object.entries(breakdown).forEach(([key, value]) => {
        const item = document.createElement('div');
        item.className = 'result-item';
        const label = document.createElement('span');
        label.textContent = programLabels[key] || key;
        const amount = document.createElement('strong');
        amount.textContent = formatCurrency(value);
        item.append(label, amount);
        resultsContainer.appendChild(item);
      });
      const netCost = document.createElement('p');
      const totalRebates = breakdown.total || 0;
      if (cost > 0) {
        const customerPortion = Math.max(cost - totalRebates, 0);
        netCost.innerHTML = `<strong>Estimated customer investment:</strong> ${formatCurrency(customerPortion)} (before GST).`;
        resultsContainer.appendChild(netCost);
      }
    }

    form.addEventListener('submit', async (event) => {
      event.preventDefault();
      statusMessage.style.display = 'none';
      statusMessage.classList.remove('error');

      const formData = new FormData(form);
      const data = Object.fromEntries(formData.entries());

      const breakdown = calculateRebates(data);
      renderResults(breakdown, Number.parseFloat(data.project_cost || '0'));

      formData.append('calculated_rebates', JSON.stringify(breakdown));

      try {
        statusMessage.textContent = 'Sending your estimate to our team…';
        statusMessage.style.display = 'block';

        const response = await fetch('https://api.web3forms.com/submit', {
          method: 'POST',
          body: formData
        });

        const result = await response.json();
        if (result.success) {
          statusMessage.textContent = 'Thanks! Your estimate was sent. We will follow up shortly.';
          form.reset();
        } else {
          throw new Error(result.message || 'Submission failed');
        }
      } catch (error) {
        console.error(error);
        statusMessage.textContent = 'We calculated your rebates, but could not send the form. Please call 604-442-6711 or email info@apexheatpumps.ca.';
        statusMessage.classList.add('error');
      }
    });
  </script>
</body>
</html>
